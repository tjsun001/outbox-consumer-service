# -----------------------------
# MSK Serverless (IAM) - Consumer
# -----------------------------

# Keep your existing ECS env var name from the smoke test
spring.kafka.bootstrap-servers=${SPRING_KAFKA_BOOTSTRAP_SERVERS}

# IAM auth over TLS
spring.kafka.properties.security.protocol=SASL_SSL
spring.kafka.properties.sasl.mechanism=AWS_MSK_IAM
spring.kafka.properties.sasl.jaas.config=software.amazon.msk.auth.iam.IAMLoginModule required;
spring.kafka.properties.sasl.client.callback.handler.class=software.amazon.msk.auth.iam.IAMClientCallbackHandler

# -----------------------------
# Consumer defaults
# -----------------------------
# Consumer group (override in ECS if you want)
spring.kafka.consumer.group-id=${APP_GROUP_ID:outbox-consumer-service}

# Start at earliest if group has no committed offsets yet (good for demos)
spring.kafka.consumer.auto-offset-reset=earliest

# Use String deserializers since your producer sends String payloads
spring.kafka.consumer.key-deserializer=org.apache.kafka.common.serialization.StringDeserializer
spring.kafka.consumer.value-deserializer=org.apache.kafka.common.serialization.StringDeserializer

# Let Spring commit offsets automatically (fine for now; we can harden later)
spring.kafka.consumer.enable-auto-commit=true

# -----------------------------
# App-level settings
# -----------------------------
# Topic to consume (defaults to the producer topic)
app.topic=${APP_TOPIC:outbox.events.test}
